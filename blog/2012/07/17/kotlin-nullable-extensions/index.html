<!DOCTYPE html>
<html><head><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="width=device-width, user-scalable=no" name="viewport"><meta content="Kotlin: Nullable Extensions" name="description"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="https://fonts.googleapis.com/css?family=Merriweather:400,700|Open+Sans:400,700" rel="stylesheet" type="text/css"><link href="/bundles/84cd5d4454d9/styles.css" rel="stylesheet" /><title>Kotlin: Nullable Extensions</title></head><body><div class="row"><blockquote class="warning">This post is over 6 months old.  Some details,
       especially technical, may have changed.</blockquote><div itemscope="" itemtype="http://schema.org/Article"><h1 itemprop="name">Kotlin: Nullable Extensions</h1><div class="post" itemprop="articleBody"><p>Haskell doesn't have if statements - that blew my mind the first time my old Scala mentor told me it. <code>if</code>s just don't work with a strong function approach. Plus you know what - <code>if</code>s are rather ugly especially when you need to wrap ALL THE THINGS in a null check. Scala has a type called <code>Option</code>. An <code>Option</code> is essentially a collection of none or one instances of a type. If everything returned an <code>Option</code> nothing would be null and you don't need to do any null checks (they are much more powerful than I am making out but for now this is all that is necessary).</p><p>Kotlin doesn't have the <code>Option</code> type but it does have two things that allow you to act like it does,</p>
<ol>
  <li>Nullable types - e.g. <code>String</code> vs <code>String?</code> , and,</li>
  <li>Nullable Extension Functions</li>
</ol><p>Remember the brief definition of an <code>Option</code> - it's a list of 0 or 1 instances of a particualr type and as such we can treat it a bit like a list. Now once we get functional with our badselves this makes null handling unnecessary. We can use all those nice little functional methods that you get with collections - map, forEach, filter, fold etc.</p><p>This means you're less inclined to use <code>if</code>s and, more importantly, less inclined to use mutable variables which is great for building performant, scalable soltions.</p><p>Lets take a really contrived example to show you what I mean. OImagine this bit of code....</p>
<pre class="highlight"><code class="java ">   <span class="n">val</span> <span class="n">auth</span> <span class="o">=</span> <span class="n">authenticate</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">)</span>
   <span class="n">var</span> <span class="n">view</span> <span class="o">:</span> <span class="n">View</span> <span class="o">=</span> <span class="kc">null</span>

   <span class="k">if</span> <span class="o">(</span><span class="n">auth</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
   		<span class="n">view</span> <span class="o">=</span> <span class="n">views</span><span class="o">.</span><span class="na">html</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="s">"Invalid Username or Password"</span><span class="o">)</span>
   <span class="o">}</span><span class="k">else</span><span class="o">{</span>
   		<span class="n">view</span> <span class="o">=</span> <span class="n">views</span><span class="o">.</span><span class="na">html</span><span class="o">.</span><span class="na">index</span><span class="o">(</span><span class="n">auth</span><span class="o">)</span>
   <span class="o">}</span>

   <span class="k">return</span> <span class="n">view</span>
</code></pre><p>We want to authenticate a user and return a certain view. Now yes we could refactor this down into something more bitsize but this is a very common state to find code - so bare with me for demonstration purposes.</p><p><code>authenticate</code> returns a user if the username and password was correct otherwise it returns null. With our nullable extensions (by importing <code>kotlin.nullable.*</code>) we can reduce this into something more Scala-like,</p>
<pre class="highlight"><code class="java "><span class="k">return</span> <span class="nf">authenticate</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">).</span><span class="na">map</span> <span class="o">{</span>
    <span class="n">views</span><span class="o">.</span><span class="na">html</span><span class="o">.</span><span class="na">index</span><span class="o">(</span><span class="n">it</span><span class="o">)</span>
<span class="o">}</span> <span class="o">?:</span> <span class="n">views</span><span class="o">.</span><span class="na">html</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="s">"Invalid Username or Password"</span><span class="o">)</span>
</code></pre><p>So what we have done here is basically take an object (the user), if it exists, and transform it to another object which we return. Otherwise we return something different. This is much simpler and avoids having to create a mutable var (yes we could have avoided that in the other example but in many cases its very difficult to achieve this). In fact I am not even a fan of the elvis operator there (<code>?:</code>) and have a Scala-like syntax <a href="https://github.com/JetBrains/kotlin/pull/100">pull request</a> open for getOrElse. A small syntactic change that I think allows you create a much neater, chainable block of code.</p><p>Thats only the tip of the iceberg on Nullable Extensions - those of you with a functional mind will be able to put these collection-like extensions to great use I reckon. Not quite Scalas <code>Option</code> type but good enough at providing the common features for me.</p></div><a class="twitter" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fyobriefca.se%2Fblog%2F2012%2F07%2F17%2Fkotlin-nullable-extensions%2F&amp;text=Kotlin%3A%20Nullable%20Extensions&amp;via=kouphax" itemprop="discussionUrl" target="_blank">Tweet This</a><div class="dater"><time datetime="17-07-2012" itemprop="datePublished">July 17, 2012</time></div><div class="categories">Published in <a href="/categories/kotlin/">Kotlin</a> on July 17, 2012</div></div></div><div class="homer"><a href="/"><i class="icon-briefcase" style="font-size:32px;"></i></a></div></body></html>
